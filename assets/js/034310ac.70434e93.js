(self.webpackChunkneon_docs=self.webpackChunkneon_docs||[]).push([[3064],{3793:(e,n,r)=>{e.exports={src:{srcSet:r.p+"assets/ideal-img/deploy-cluster.8ef9fb4.100.png 100w,"+r.p+"assets/ideal-img/deploy-cluster.2928cff.241.png 241w",images:[{path:r.p+"assets/ideal-img/deploy-cluster.8ef9fb4.100.png",width:100,height:178},{path:r.p+"assets/ideal-img/deploy-cluster.2928cff.241.png",width:241,height:428}],src:r.p+"assets/ideal-img/deploy-cluster.8ef9fb4.100.png",toString:function(){return r.p+"assets/ideal-img/deploy-cluster.8ef9fb4.100.png"},placeholder:void 0,width:100,height:178},preSrc:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAASCAYAAABit09LAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB7ElEQVR4nG2RS08TYRiF+yOsvVF0oSYujIm/wMRf5saIK2Mal2JASumVUrowhhWLmpREpPPFEjozrU2hM0zn1umNUB4zAwRET/Ll3Tw557zvF3r98TOlrzvkczk2NrLk8wXSa2mq1Sr1+h5vl96xkHxIaHdfcOp4NJtNdF3HcV00TcO2bXxtlreIJxYJbdf22W1plL83+NZQ2JFU6j2HWmfAT2PGh9UcCR+s/Wig6hZ70iFyT6Ojm3QNh9+6hTmds7pRuHT8JQRDx0FVZE56XTzXZToeB9NXqVS6BBuSwLJtFEVFP9Vxhy7eaBR09VUsXoFCCAamhawoTKcTRuMxo9EI9y4oSQLbdmgeNumfnDCZTPC8/4BCCEzT5Kh1xHA4DNz+dty8BVom7U6b8VXsbbBQKN6KdmxkWWbounieFzwfvLi4IJvN3Thalh38jGEYzGazwNFxnH+X8c8jJEG32+XUMBgMjKDvHVAKYjqdDv1+H0VVOT7u3XS8Bg8ODhgMTGS5FXS8XsiyrKBjvlAgvrBIqN1uMzs7Q9M15vN54OLr/Pw8mFuVbSLRJKFUKsXKygrLy5/IZDOsZdKkM+t8WV+jXKmw9P4Nz14+IRSLxYjEIkTjEcKxMOHEfcKJCOFklHsP4jx68Zjnr57yB7rHR/TXuoEwAAAAAElFTkSuQmCC"}},6708:(e,n,r)=>{"use strict";r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>a,toc:()=>c});var t=r(4848),s=r(8453),i=(r(4182),r(1801),r(3012));r(7227),r(9489);const o={sidebar_position:7,displayed_sidebar:"neonkube",title:"Deploy on Azure",hide_title:!1,hide_table_of_contents:!1,description:"Getting started with NeonKUBE on Azure",keywords:["azure"],last_update:{author:"NeonFORGE Team"}},l="Deploy on Azure",a={id:"neonkube/getting-started/azure",title:"Deploy on Azure",description:"Getting started with NeonKUBE on Azure",source:"@site/docs/neonkube/getting-started/azure.mdx",sourceDirName:"neonkube/getting-started",slug:"/neonkube/getting-started/azure",permalink:"/docs/neonkube/getting-started/azure",draft:!1,unlisted:!1,editUrl:"https://github.com/nforgeio/documentation/edit/master/docs/neonkube/getting-started/azure.mdx",tags:[],version:"current",sidebarPosition:7,frontMatter:{sidebar_position:7,displayed_sidebar:"neonkube",title:"Deploy on Azure",hide_title:!1,hide_table_of_contents:!1,description:"Getting started with NeonKUBE on Azure",keywords:["azure"],last_update:{author:"NeonFORGE Team"}},sidebar:"neonkube",previous:{title:"Deploy on AWS",permalink:"/docs/neonkube/getting-started/aws"},next:{title:"Deploy on XenServer/XCP-ng",permalink:"/docs/neonkube/getting-started/xenserver"}},d={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Azure Subscription Credentials",id:"azure-subscription-credentials",level:2},{value:"Cluster Definition",id:"cluster-definition",level:2},{value:"Cluster Deployment via NeonDESKTOP",id:"cluster-deployment-via-neondesktop",level:2},{value:"Cluster Deployment via NeonCLI",id:"cluster-deployment-via-neoncli",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"deploy-on-azure",children:"Deploy on Azure"}),"\n",(0,t.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Install NeonDESKTOP: ",(0,t.jsx)(n.a,{href:"./neon-desktop",children:"instructions"})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["You'll also need to know your ",(0,t.jsx)(n.strong,{children:"AZURE_SUBSCRIPTION_ID"})]}),"\n",(0,t.jsx)(n.p,{children:"$todo(jefflill): document how to obtain this"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"azure-subscription-credentials",children:"Azure Subscription Credentials"}),"\n",(0,t.jsx)(n.p,{children:"NeonKUBE will need your Azure subscription credentials so it will be able to\r\ndeploy and manage the cluster. You'll also need to accept the NeonKUBE offer\r\nEULA on Azure."}),"\n",(0,t.jsxs)(n.p,{children:["Install the\r\n",(0,t.jsx)(n.a,{href:"https://api-docs.neonforge.com/neonkube/api/Neon.Kube.ClusterDef.ClusterDefinition.html",children:"Azure CLI"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Run the following command to obtain your subscription credentials:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plain",children:"az ad sp create-for-rbac --name USER --role owner --scopes /subscriptions/AZURE_SUBSCRIPTION_ID\n"})}),"\n",(0,t.jsx)(n.p,{children:"The output will be something like:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\r\n  "appId": "[AZURE_CLIENT_ID]",\r\n  "displayName": "example-app-name",\r\n  "name": "http://example-app-name",\r\n  "password": "[AZURE_CLIENT_SECRET]",\r\n  "tenant": "[AZURE_TENANT_ID]"\r\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["We'll use the ",(0,t.jsx)(n.strong,{children:"[AZURE_CLIENT_ID]"}),", ",(0,t.jsx)(n.strong,{children:"[AZURE_CLIENT_SECRET]"}),", and\r\n",(0,t.jsx)(n.strong,{children:"[AZURE_TENANT_ID]"})," from the output plus the ",(0,t.jsx)(n.strong,{children:"AZURE_SUBSCRIPTION_ID"})," you\r\nalready know."]}),"\n",(0,t.jsx)(n.p,{children:"Next, you'll need to accept the NeonKUBE offer terms and EULA, via the\r\nAZURE-CLI:"}),"\n",(0,t.jsx)(n.p,{children:"View the offer terms:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plain",children:"az vm image terms show --urn neonforge:neonkube:0-11-0-beta-0:0.11.0\n"})}),"\n",(0,t.jsx)(n.p,{children:"Accept the terms"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plain",children:"az vm image terms accept --urn neonforge:neonkube:0-11-0-beta-0:0.11.0\n"})}),"\n",(0,t.jsxs)(n.admonition,{type:"note",children:[(0,t.jsx)(n.p,{children:"Azure doesn't directly support semantic versioning of their Virtual Machine\r\nImages, so we have to do some version contortions to get this to work. We'll\r\nprobably add a NeonCLI command that figures out the version and then launches\r\nAZURE-CLI with the correct paramweters."}),(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.strong,{children:"0-11-0-beta-0:0.11.0"})," version part of the URN above is formatted with the first\r\npart being the full semantic version of the release ",(0,t.jsx)(n.em,{children:"0.11.0"})," with all dots\r\nreplaced by dashes like ",(0,t.jsx)(n.em,{children:"0-11-0"})," and the second part being the ",(0,t.jsx)(n.strong,{children:"major"}),",\r\n",(0,t.jsx)(n.strong,{children:"minor"}),", and ",(0,t.jsx)(n.strong,{children:"patch"})," version of the release only."]})]}),"\n",(0,t.jsx)(n.h2,{id:"cluster-definition",children:"Cluster Definition"}),"\n",(0,t.jsxs)(n.p,{children:["Create a\r\n",(0,t.jsx)(n.a,{href:"https://api-docs.neonforge.com/neonkube/api/Neon.Kube.ClusterDef.ClusterDefinition.html",children:"Cluster Definition"}),"\r\nthat describes the cluster."]}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsxs)(n.p,{children:["Make sure that the Azure account has enough\r\n",(0,t.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/azure-subscription-service-limits",children:"Resource Quota"}),"\r\nto deploy cluster virtual machines."]})}),"\n",(0,t.jsx)(n.p,{children:"Be sure to substitute the following from the previous steps:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"AZURE_SUBSCRIPTION_ID"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"AZURE_TENANT_ID"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"AZURE_CLIENT_ID"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"AZURE_CLIENT_SECRET"})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"name: my-azure-cluster\r\ndatacenter: westus2\r\nhosting:\r\n  environment: azure\r\n  cloud:\r\n    prefixResourceNames: default\r\n  azure:\r\n    subscriptionId: [AZURE_SUBSCRIPTION_ID]\r\n    tenantId: [AZURE_TENANT_ID]\r\n    clientId: [AZURE_CLIENT_ID]\r\n    clientSecret: [AZURE_CLIENT_SECRET]\r\n    region: westus2\r\n    defaultVmSize: Standard_E4vs_v5\r\nnodes:\r\n  control-0:\r\n    role: control-plane\n"})}),"\n",(0,t.jsx)(n.p,{children:"Save the modified cluster definition somewhere on your disk."}),"\n",(0,t.jsx)(n.h2,{id:"cluster-deployment-via-neondesktop",children:"Cluster Deployment via NeonDESKTOP"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Right click the NeonDESKTOP icon in the taskbar > Deploy cluster"}),"\n",(0,t.jsx)(i.A,{className:"max-w-72 w-full",img:r(3793)}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Use the file picker to select the cluster definiton file you saved above"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Grab a coffee and wait for NeonDESKTOP to deploy the cluster."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"cluster-deployment-via-neoncli",children:"Cluster Deployment via NeonCLI"}),"\n",(0,t.jsx)(n.p,{children:"Cluster deployment happens in two phases:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Configuring the hosting infrastructure, which involves configuring the\r\n",(0,t.jsx)(n.strong,{children:"Resource Group"}),", ",(0,t.jsx)(n.strong,{children:"Virtual Networl"}),", starting the ",(0,t.jsx)(n.strong,{children:"VMs"}),", configuring the\r\n",(0,t.jsx)(n.strong,{children:"LoadBalancer"}),", ",(0,t.jsx)(n.strong,{children:"IP Addresses"}),", ",(0,t.jsx)(n.strong,{children:"Disks"}),", etc."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Setting up the cluster. This involves configuring Linux and Kubernetes and\r\nthen installing the necessary cluster components via Helm charts."}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Execute the commands to deploy this cluster, passing the ",(0,t.jsx)(n.strong,{children:"PATH"})," to the cluster\r\ndefinition file you saved above and ",(0,t.jsx)(n.strong,{children:"CLUSTERNAME"})," to the cluster name as\r\ndefined in the definition:"]}),"\n",(0,t.jsx)(n.p,{children:"Prepare the cluster infrastructure"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plain",children:"neon cluster prepare /path/to/your/cluster-definition.yaml\n"})}),"\n",(0,t.jsx)(n.p,{children:"Setup the cluster"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plain",children:"neon cluster setup sysadmin@my-azure-cluster\n"})}),"\n",(0,t.jsx)(n.p,{children:"Then wait for cluster setup to complete."}),"\n",(0,t.jsxs)(n.admonition,{type:"note",children:[(0,t.jsx)(n.p,{children:"These operations are currently coordinated by NeonDESKTOP or NeonCLI running on\r\nyour machine, so you'll need to keep your computer running and connected to the\r\nnetwork."}),(0,t.jsx)(n.p,{children:"We plan on supporting cloud based deployment in the future where these\r\noperations will be managed in the cloud, rather than from your computer."})]})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}}}]);